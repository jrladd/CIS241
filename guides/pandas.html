<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>11&nbsp; Pandas – CIS241 Intro to Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<link href="../guides/altair.html" rel="next">
<link href="../guides/python.html" rel="prev">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-2d053c8a602df91ec61aa3379e601c1a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">CIS241 Intro to Data Science</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../schedule.html"> 
<span class="menu-text">Course Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../assignments.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../policies.html"> 
<span class="menu-text">Course Policies</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../groundrules.html"> 
<span class="menu-text">Ground Rules</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://jupyterhub.ciswashjeff.net/"> 
<span class="menu-text">JupyterHub</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../guides/jupyterhub.html">Guides</a></li><li class="breadcrumb-item"><a href="../guides/pandas.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Pandas</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/startrek.jpg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Homepage</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Information</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Course Schedule</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../policies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Course Policies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../groundrules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ground Rules</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../assignments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/documentation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Documentation Assignment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/project-planning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Project Planning Document</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/presentation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Presentation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/final-report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Final Project</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Guides</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../guides/jupyterhub.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">JupyterHub</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../guides/python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../guides/pandas.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../guides/altair.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Altair</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Other Key Info</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../how-to-explain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">How to Explain in CIS241</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../radcat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">R.A.D. C.A.T.</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sample-final-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Work Acquistion and Gender in the Museum of Modern Art</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../guides/jupyter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Advanced Jupyter Setup</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#dataframes-and-series" id="toc-dataframes-and-series" class="nav-link active" data-scroll-target="#dataframes-and-series"><span class="header-section-number">11.1</span> DataFrames and Series</a></li>
  <li><a href="#selecting-rows-and-columns" id="toc-selecting-rows-and-columns" class="nav-link" data-scroll-target="#selecting-rows-and-columns"><span class="header-section-number">11.2</span> Selecting Rows and Columns</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling"><span class="header-section-number">11.3</span> Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#sorting" id="toc-sorting" class="nav-link" data-scroll-target="#sorting"><span class="header-section-number">11.3.1</span> Sorting</a></li>
  <li><a href="#counting" id="toc-counting" class="nav-link" data-scroll-target="#counting"><span class="header-section-number">11.3.2</span> Counting</a></li>
  <li><a href="#renaming-columns" id="toc-renaming-columns" class="nav-link" data-scroll-target="#renaming-columns"><span class="header-section-number">11.3.3</span> Renaming Columns</a></li>
  <li><a href="#create-new-columns" id="toc-create-new-columns" class="nav-link" data-scroll-target="#create-new-columns"><span class="header-section-number">11.3.4</span> Create new columns</a></li>
  <li><a href="#grouping-and-summarizing" id="toc-grouping-and-summarizing" class="nav-link" data-scroll-target="#grouping-and-summarizing"><span class="header-section-number">11.3.5</span> Grouping and Summarizing</a></li>
  <li><a href="#dropping-null-values" id="toc-dropping-null-values" class="nav-link" data-scroll-target="#dropping-null-values"><span class="header-section-number">11.3.6</span> Dropping Null Values</a></li>
  </ul></li>
  <li><a href="#sampling" id="toc-sampling" class="nav-link" data-scroll-target="#sampling"><span class="header-section-number">11.4</span> Sampling</a></li>
  <li><a href="#combining-datasets" id="toc-combining-datasets" class="nav-link" data-scroll-target="#combining-datasets"><span class="header-section-number">11.5</span> Combining Datasets</a>
  <ul class="collapse">
  <li><a href="#stack-data-with-concatenation" id="toc-stack-data-with-concatenation" class="nav-link" data-scroll-target="#stack-data-with-concatenation"><span class="header-section-number">11.5.1</span> Stack Data with Concatenation</a></li>
  <li><a href="#switch-rows-and-columns-with-pivot-and-melt" id="toc-switch-rows-and-columns-with-pivot-and-melt" class="nav-link" data-scroll-target="#switch-rows-and-columns-with-pivot-and-melt"><span class="header-section-number">11.5.2</span> Switch Rows and Columns with Pivot and Melt</a></li>
  <li><a href="#join-datasets-with-merge" id="toc-join-datasets-with-merge" class="nav-link" data-scroll-target="#join-datasets-with-merge"><span class="header-section-number">11.5.3</span> Join Datasets with Merge</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../guides/jupyterhub.html">Guides</a></li><li class="breadcrumb-item"><a href="../guides/pandas.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Pandas</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Pandas</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Pandas is a library for storing and manipulating tabular data, or data stored in rows and columns like a spreadsheet. Pandas is a huge library with many different functions and methods, so what follows is a brief introduction to the most important functions for data management.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you encounter any part of Pandas out in the wild that you don’t see here, you can always refer to the <a href="https://pandas.pydata.org/docs/user_guide/index.html#user-guide">Pandas documentation</a>.</p>
</div>
</div>
<section id="dataframes-and-series" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="dataframes-and-series"><span class="header-section-number">11.1</span> DataFrames and Series</h2>
<p>Instead of normal Python lists and dictionaries, Pandas stores data in its own specialized objects. The main one is a <em>DataFrame</em>, which is a lot like a spreadsheet with rows and columns.</p>
<p>You can create a DataFrame directly with the <code>DataFrame()</code> class in Pandas, but it’s more likely that you’ll read in a DataFrame from a CSV or spreadsheet file. First you must import the library, and it’s a good idea to import the <code>numpy</code> library as well.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Numpy is a Python library for efficiently handling arrays and matrices of numbers. Pandas uses it under the hood to run quickly. You usually won’t need to use it directly, but it’s good to have it installed to avoid any mysterious errors.</p>
</div>
</div>
<div id="a2852e73-f952-41e1-a670-d7138f2ca43b" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now you can use the <code>read_csv()</code> function to read in a comma-separated value (CSV) spreadsheet file. You must put the name of this file in quotes, and the file should be in the same directory as your Jupyter notebook (or else you should include a full path). The <code>read_csv()</code> function will also accept a URL that points to a CSV file online.</p>
<p>For this example, we’ll use the file <code>mpg.csv</code> which comes from R’s <a href="https://www.rdocumentation.org/packages/ggplot2/versions/3.4.1/topics/mpg">ggplot2 library</a>.</p>
<div id="fe0d31e0-8aee-46cb-ac17-3aafa9e9024c" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mpg <span class="op">=</span> pd.read_csv(<span class="st">"../data/mpg.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">displ</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">drv</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">hwy</th>
<th data-quarto-table-cell-role="th">fl</th>
<th data-quarto-table-cell-role="th">class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>auto(l5)</td>
<td>f</td>
<td>18</td>
<td>29</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>20</td>
<td>31</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(av)</td>
<td>f</td>
<td>21</td>
<td>30</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>audi</td>
<td>a4</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">229</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(s6)</td>
<td>f</td>
<td>19</td>
<td>28</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">230</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">231</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">232</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>manual(m5)</td>
<td>f</td>
<td>18</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">233</td>
<td>volkswagen</td>
<td>passat</td>
<td>3.6</td>
<td>2008</td>
<td>6</td>
<td>auto(s6)</td>
<td>f</td>
<td>17</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
</tr>
</tbody>
</table>

<p>234 rows × 11 columns</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Jupyter nicely formats DataFrames as tables when you type the name of a variable containing a DataFrame. But if you use the <code>print()</code> function, it won’t display as well.</p>
</div>
</div>
<p>You can get basic information about your DataFrames columns using the <code>.info()</code> method.</p>
<div id="e8fcaa3a-6616-40f1-8f3b-98c6056378a2" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mpg.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 234 entries, 0 to 233
Data columns (total 11 columns):
 #   Column        Non-Null Count  Dtype  
---  ------        --------------  -----  
 0   manufacturer  234 non-null    object 
 1   model         234 non-null    object 
 2   displ         234 non-null    float64
 3   year          234 non-null    int64  
 4   cyl           234 non-null    int64  
 5   trans         234 non-null    object 
 6   drv           234 non-null    object 
 7   cty           234 non-null    int64  
 8   hwy           234 non-null    int64  
 9   fl            234 non-null    object 
 10  class         234 non-null    object 
dtypes: float64(1), int64(4), object(6)
memory usage: 20.2+ KB</code></pre>
</div>
</div>
<p>A <em>Series</em> is a lot like a Python list, and each column of a DataFrame is a Series. You can access the columns of a Dataframe with dot notation.</p>
<div id="3cf5b442-aed7-436d-a193-dd65a43420a6" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mpg.model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>0          a4
1          a4
2          a4
3          a4
4          a4
        ...  
229    passat
230    passat
231    passat
232    passat
233    passat
Name: model, Length: 234, dtype: object</code></pre>
</div>
</div>
<p>You can also turn a list into a Series with the <code>Series()</code> class.</p>
<div id="56c8fe04-db20-4d8f-b9d2-0cd6fe6382c5" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>myseries <span class="op">=</span> pd.Series([<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>])</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>myseries</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>0    5
1    6
2    7
3    8
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="selecting-rows-and-columns" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="selecting-rows-and-columns"><span class="header-section-number">11.2</span> Selecting Rows and Columns</h2>
<p>Once you have a DataFrame, you’ll typically want to filter and select different rows or columns.</p>
<p>To filter specific rows, Pandas uses a bracket notation. It takes conditional statements that are similar to <a href="../python.html#conditions">Python conditions</a>.</p>
<div id="6a5f1c32-c585-47e5-99b7-823a06f547ad" class="cell" data-tags="[]" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get cars with fewer than 6 cylinders</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>four_cylinders <span class="op">=</span> mpg[mpg.cyl <span class="op">&lt;</span> <span class="dv">6</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>four_cylinders</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">displ</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">drv</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">hwy</th>
<th data-quarto-table-cell-role="th">fl</th>
<th data-quarto-table-cell-role="th">class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>auto(l5)</td>
<td>f</td>
<td>18</td>
<td>29</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>20</td>
<td>31</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(av)</td>
<td>f</td>
<td>21</td>
<td>30</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>audi</td>
<td>a4 quattro</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>4</td>
<td>18</td>
<td>26</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">226</td>
<td>volkswagen</td>
<td>new beetle</td>
<td>2.5</td>
<td>2008</td>
<td>5</td>
<td>auto(s6)</td>
<td>f</td>
<td>20</td>
<td>29</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">227</td>
<td>volkswagen</td>
<td>passat</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">228</td>
<td>volkswagen</td>
<td>passat</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>auto(l5)</td>
<td>f</td>
<td>18</td>
<td>29</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">229</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(s6)</td>
<td>f</td>
<td>19</td>
<td>28</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">230</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>midsize</td>
</tr>
</tbody>
</table>

<p>85 rows × 11 columns</p>
</div>
</div>
</div>
<p>You can also use the operators <code>&amp;</code> (and), <code>|</code> (or), and <code>!</code> (not) to combine conditional filters.</p>
<div id="5eaa9859-1130-4921-9531-ae3a400f6b4c" class="cell" data-tags="[]" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Volkswagens and Fords</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>vw_ford <span class="op">=</span> mpg[(mpg.manufacturer <span class="op">==</span> <span class="st">'volkswagen'</span>) <span class="op">|</span> (mpg.manufacturer <span class="op">==</span> <span class="st">'ford'</span>)]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>vw_ford</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">displ</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">drv</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">hwy</th>
<th data-quarto-table-cell-role="th">fl</th>
<th data-quarto-table-cell-role="th">class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">74</td>
<td>ford</td>
<td>expedition 2wd</td>
<td>4.6</td>
<td>1999</td>
<td>8</td>
<td>auto(l4)</td>
<td>r</td>
<td>11</td>
<td>17</td>
<td>r</td>
<td>suv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75</td>
<td>ford</td>
<td>expedition 2wd</td>
<td>5.4</td>
<td>1999</td>
<td>8</td>
<td>auto(l4)</td>
<td>r</td>
<td>11</td>
<td>17</td>
<td>r</td>
<td>suv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76</td>
<td>ford</td>
<td>expedition 2wd</td>
<td>5.4</td>
<td>2008</td>
<td>8</td>
<td>auto(l6)</td>
<td>r</td>
<td>12</td>
<td>18</td>
<td>r</td>
<td>suv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">77</td>
<td>ford</td>
<td>explorer 4wd</td>
<td>4.0</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>4</td>
<td>14</td>
<td>17</td>
<td>r</td>
<td>suv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">78</td>
<td>ford</td>
<td>explorer 4wd</td>
<td>4.0</td>
<td>1999</td>
<td>6</td>
<td>manual(m5)</td>
<td>4</td>
<td>15</td>
<td>19</td>
<td>r</td>
<td>suv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">79</td>
<td>ford</td>
<td>explorer 4wd</td>
<td>4.0</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>4</td>
<td>14</td>
<td>17</td>
<td>r</td>
<td>suv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">80</td>
<td>ford</td>
<td>explorer 4wd</td>
<td>4.0</td>
<td>2008</td>
<td>6</td>
<td>auto(l5)</td>
<td>4</td>
<td>13</td>
<td>19</td>
<td>r</td>
<td>suv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">81</td>
<td>ford</td>
<td>explorer 4wd</td>
<td>4.6</td>
<td>2008</td>
<td>8</td>
<td>auto(l6)</td>
<td>4</td>
<td>13</td>
<td>19</td>
<td>r</td>
<td>suv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">82</td>
<td>ford</td>
<td>explorer 4wd</td>
<td>5.0</td>
<td>1999</td>
<td>8</td>
<td>auto(l4)</td>
<td>4</td>
<td>13</td>
<td>17</td>
<td>r</td>
<td>suv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83</td>
<td>ford</td>
<td>f150 pickup 4wd</td>
<td>4.2</td>
<td>1999</td>
<td>6</td>
<td>auto(l4)</td>
<td>4</td>
<td>14</td>
<td>17</td>
<td>r</td>
<td>pickup</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">84</td>
<td>ford</td>
<td>f150 pickup 4wd</td>
<td>4.2</td>
<td>1999</td>
<td>6</td>
<td>manual(m5)</td>
<td>4</td>
<td>14</td>
<td>17</td>
<td>r</td>
<td>pickup</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">85</td>
<td>ford</td>
<td>f150 pickup 4wd</td>
<td>4.6</td>
<td>1999</td>
<td>8</td>
<td>manual(m5)</td>
<td>4</td>
<td>13</td>
<td>16</td>
<td>r</td>
<td>pickup</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">86</td>
<td>ford</td>
<td>f150 pickup 4wd</td>
<td>4.6</td>
<td>1999</td>
<td>8</td>
<td>auto(l4)</td>
<td>4</td>
<td>13</td>
<td>16</td>
<td>r</td>
<td>pickup</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">87</td>
<td>ford</td>
<td>f150 pickup 4wd</td>
<td>4.6</td>
<td>2008</td>
<td>8</td>
<td>auto(l4)</td>
<td>4</td>
<td>13</td>
<td>17</td>
<td>r</td>
<td>pickup</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">88</td>
<td>ford</td>
<td>f150 pickup 4wd</td>
<td>5.4</td>
<td>1999</td>
<td>8</td>
<td>auto(l4)</td>
<td>4</td>
<td>11</td>
<td>15</td>
<td>r</td>
<td>pickup</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">89</td>
<td>ford</td>
<td>f150 pickup 4wd</td>
<td>5.4</td>
<td>2008</td>
<td>8</td>
<td>auto(l4)</td>
<td>4</td>
<td>13</td>
<td>17</td>
<td>r</td>
<td>pickup</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">90</td>
<td>ford</td>
<td>mustang</td>
<td>3.8</td>
<td>1999</td>
<td>6</td>
<td>manual(m5)</td>
<td>r</td>
<td>18</td>
<td>26</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">91</td>
<td>ford</td>
<td>mustang</td>
<td>3.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l4)</td>
<td>r</td>
<td>18</td>
<td>25</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">92</td>
<td>ford</td>
<td>mustang</td>
<td>4.0</td>
<td>2008</td>
<td>6</td>
<td>manual(m5)</td>
<td>r</td>
<td>17</td>
<td>26</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">93</td>
<td>ford</td>
<td>mustang</td>
<td>4.0</td>
<td>2008</td>
<td>6</td>
<td>auto(l5)</td>
<td>r</td>
<td>16</td>
<td>24</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">94</td>
<td>ford</td>
<td>mustang</td>
<td>4.6</td>
<td>1999</td>
<td>8</td>
<td>auto(l4)</td>
<td>r</td>
<td>15</td>
<td>21</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">95</td>
<td>ford</td>
<td>mustang</td>
<td>4.6</td>
<td>1999</td>
<td>8</td>
<td>manual(m5)</td>
<td>r</td>
<td>15</td>
<td>22</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">96</td>
<td>ford</td>
<td>mustang</td>
<td>4.6</td>
<td>2008</td>
<td>8</td>
<td>manual(m5)</td>
<td>r</td>
<td>15</td>
<td>23</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">97</td>
<td>ford</td>
<td>mustang</td>
<td>4.6</td>
<td>2008</td>
<td>8</td>
<td>auto(l5)</td>
<td>r</td>
<td>15</td>
<td>22</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">98</td>
<td>ford</td>
<td>mustang</td>
<td>5.4</td>
<td>2008</td>
<td>8</td>
<td>manual(m6)</td>
<td>r</td>
<td>14</td>
<td>20</td>
<td>p</td>
<td>subcompact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">207</td>
<td>volkswagen</td>
<td>gti</td>
<td>2.0</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>r</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">208</td>
<td>volkswagen</td>
<td>gti</td>
<td>2.0</td>
<td>1999</td>
<td>4</td>
<td>auto(l4)</td>
<td>f</td>
<td>19</td>
<td>26</td>
<td>r</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">209</td>
<td>volkswagen</td>
<td>gti</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">210</td>
<td>volkswagen</td>
<td>gti</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(s6)</td>
<td>f</td>
<td>22</td>
<td>29</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">211</td>
<td>volkswagen</td>
<td>gti</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>manual(m5)</td>
<td>f</td>
<td>17</td>
<td>24</td>
<td>r</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">212</td>
<td>volkswagen</td>
<td>jetta</td>
<td>1.9</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>33</td>
<td>44</td>
<td>d</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">213</td>
<td>volkswagen</td>
<td>jetta</td>
<td>2.0</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>r</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">214</td>
<td>volkswagen</td>
<td>jetta</td>
<td>2.0</td>
<td>1999</td>
<td>4</td>
<td>auto(l4)</td>
<td>f</td>
<td>19</td>
<td>26</td>
<td>r</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">215</td>
<td>volkswagen</td>
<td>jetta</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(s6)</td>
<td>f</td>
<td>22</td>
<td>29</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">216</td>
<td>volkswagen</td>
<td>jetta</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">217</td>
<td>volkswagen</td>
<td>jetta</td>
<td>2.5</td>
<td>2008</td>
<td>5</td>
<td>auto(s6)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>r</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">218</td>
<td>volkswagen</td>
<td>jetta</td>
<td>2.5</td>
<td>2008</td>
<td>5</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>r</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">219</td>
<td>volkswagen</td>
<td>jetta</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l4)</td>
<td>f</td>
<td>16</td>
<td>23</td>
<td>r</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">220</td>
<td>volkswagen</td>
<td>jetta</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>manual(m5)</td>
<td>f</td>
<td>17</td>
<td>24</td>
<td>r</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">221</td>
<td>volkswagen</td>
<td>new beetle</td>
<td>1.9</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>35</td>
<td>44</td>
<td>d</td>
<td>subcompact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">222</td>
<td>volkswagen</td>
<td>new beetle</td>
<td>1.9</td>
<td>1999</td>
<td>4</td>
<td>auto(l4)</td>
<td>f</td>
<td>29</td>
<td>41</td>
<td>d</td>
<td>subcompact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">223</td>
<td>volkswagen</td>
<td>new beetle</td>
<td>2.0</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">224</td>
<td>volkswagen</td>
<td>new beetle</td>
<td>2.0</td>
<td>1999</td>
<td>4</td>
<td>auto(l4)</td>
<td>f</td>
<td>19</td>
<td>26</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">225</td>
<td>volkswagen</td>
<td>new beetle</td>
<td>2.5</td>
<td>2008</td>
<td>5</td>
<td>manual(m5)</td>
<td>f</td>
<td>20</td>
<td>28</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">226</td>
<td>volkswagen</td>
<td>new beetle</td>
<td>2.5</td>
<td>2008</td>
<td>5</td>
<td>auto(s6)</td>
<td>f</td>
<td>20</td>
<td>29</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">227</td>
<td>volkswagen</td>
<td>passat</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">228</td>
<td>volkswagen</td>
<td>passat</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>auto(l5)</td>
<td>f</td>
<td>18</td>
<td>29</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">229</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(s6)</td>
<td>f</td>
<td>19</td>
<td>28</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">230</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">231</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">232</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>manual(m5)</td>
<td>f</td>
<td>18</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">233</td>
<td>volkswagen</td>
<td>passat</td>
<td>3.6</td>
<td>2008</td>
<td>6</td>
<td>auto(s6)</td>
<td>f</td>
<td>17</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>You can use a double bracket notation to select a subset of columns.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using single brackets or dot notation will get you a single column as a Series.</p>
</div>
</div>
<div id="fc9e81e4-f6d5-4264-be69-2d77405de3d1" class="cell" data-tags="[]" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>class_cty_hwy <span class="op">=</span> mpg[[<span class="st">"class"</span>, <span class="st">"cty"</span>, <span class="st">"hwy"</span>]]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>class_cty_hwy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">class</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">hwy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>compact</td>
<td>18</td>
<td>29</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>compact</td>
<td>21</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>compact</td>
<td>20</td>
<td>31</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>compact</td>
<td>21</td>
<td>30</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>compact</td>
<td>16</td>
<td>26</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">229</td>
<td>midsize</td>
<td>19</td>
<td>28</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">230</td>
<td>midsize</td>
<td>21</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">231</td>
<td>midsize</td>
<td>16</td>
<td>26</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">232</td>
<td>midsize</td>
<td>18</td>
<td>26</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">233</td>
<td>midsize</td>
<td>17</td>
<td>26</td>
</tr>
</tbody>
</table>

<p>234 rows × 3 columns</p>
</div>
</div>
</div>
</section>
<section id="data-wrangling" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="data-wrangling"><span class="header-section-number">11.3</span> Data Wrangling</h2>
<p>In addtion to selecting rows and columns from DataFrames, you can also use Pandas to do a wide variety of data transformations.</p>
<section id="sorting" class="level3" data-number="11.3.1">
<h3 data-number="11.3.1" class="anchored" data-anchor-id="sorting"><span class="header-section-number">11.3.1</span> Sorting</h3>
<div id="15054f8a-7700-4ffe-8f24-f7af5b8aad5d" class="cell" data-tags="[]" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mpg.sort_values(<span class="st">"year"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">displ</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">drv</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">hwy</th>
<th data-quarto-table-cell-role="th">fl</th>
<th data-quarto-table-cell-role="th">class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">117</td>
<td>hyundai</td>
<td>tiburon</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>20</td>
<td>28</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">120</td>
<td>hyundai</td>
<td>tiburon</td>
<td>2.7</td>
<td>2008</td>
<td>6</td>
<td>manual(m6)</td>
<td>f</td>
<td>16</td>
<td>24</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">122</td>
<td>jeep</td>
<td>grand cherokee 4wd</td>
<td>3.0</td>
<td>2008</td>
<td>6</td>
<td>auto(l5)</td>
<td>4</td>
<td>17</td>
<td>22</td>
<td>d</td>
<td>suv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">123</td>
<td>jeep</td>
<td>grand cherokee 4wd</td>
<td>3.7</td>
<td>2008</td>
<td>6</td>
<td>auto(l5)</td>
<td>4</td>
<td>15</td>
<td>19</td>
<td>r</td>
<td>suv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">126</td>
<td>jeep</td>
<td>grand cherokee 4wd</td>
<td>4.7</td>
<td>2008</td>
<td>8</td>
<td>auto(l5)</td>
<td>4</td>
<td>9</td>
<td>12</td>
<td>e</td>
<td>suv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">130</td>
<td>land rover</td>
<td>range rover</td>
<td>4.0</td>
<td>1999</td>
<td>8</td>
<td>auto(l4)</td>
<td>4</td>
<td>11</td>
<td>15</td>
<td>p</td>
<td>suv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50</td>
<td>dodge</td>
<td>dakota pickup 4wd</td>
<td>3.9</td>
<td>1999</td>
<td>6</td>
<td>auto(l4)</td>
<td>4</td>
<td>13</td>
<td>17</td>
<td>r</td>
<td>pickup</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">51</td>
<td>dodge</td>
<td>dakota pickup 4wd</td>
<td>3.9</td>
<td>1999</td>
<td>6</td>
<td>manual(m5)</td>
<td>4</td>
<td>14</td>
<td>17</td>
<td>r</td>
<td>pickup</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">125</td>
<td>jeep</td>
<td>grand cherokee 4wd</td>
<td>4.7</td>
<td>1999</td>
<td>8</td>
<td>auto(l4)</td>
<td>4</td>
<td>14</td>
<td>17</td>
<td>r</td>
<td>suv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>auto(l5)</td>
<td>f</td>
<td>18</td>
<td>29</td>
<td>p</td>
<td>compact</td>
</tr>
</tbody>
</table>

<p>234 rows × 11 columns</p>
</div>
</div>
</div>
</section>
<section id="counting" class="level3" data-number="11.3.2">
<h3 data-number="11.3.2" class="anchored" data-anchor-id="counting"><span class="header-section-number">11.3.2</span> Counting</h3>
<div id="f9cb36ba-bac5-4834-8c7a-c88820655808" class="cell" data-tags="[]" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mpg.value_counts(<span class="st">"manufacturer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>manufacturer
dodge         37
toyota        34
volkswagen    27
ford          25
chevrolet     19
audi          18
hyundai       14
subaru        14
nissan        13
honda          9
jeep           8
pontiac        5
land rover     4
mercury        4
lincoln        3
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="renaming-columns" class="level3" data-number="11.3.3">
<h3 data-number="11.3.3" class="anchored" data-anchor-id="renaming-columns"><span class="header-section-number">11.3.3</span> Renaming Columns</h3>
<div id="650b6f1e-f66e-47d7-b209-a5d8113259e3" class="cell" data-tags="[]" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note the use of a Python dictionary as this method's argument</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>mpg <span class="op">=</span> mpg.rename({<span class="st">"cty"</span>:<span class="st">"city"</span>, <span class="st">"hwy"</span>: <span class="st">"highway"</span>})</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">displ</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">drv</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">hwy</th>
<th data-quarto-table-cell-role="th">fl</th>
<th data-quarto-table-cell-role="th">class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>auto(l5)</td>
<td>f</td>
<td>18</td>
<td>29</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>20</td>
<td>31</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(av)</td>
<td>f</td>
<td>21</td>
<td>30</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>audi</td>
<td>a4</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">229</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(s6)</td>
<td>f</td>
<td>19</td>
<td>28</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">230</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">231</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">232</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>manual(m5)</td>
<td>f</td>
<td>18</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">233</td>
<td>volkswagen</td>
<td>passat</td>
<td>3.6</td>
<td>2008</td>
<td>6</td>
<td>auto(s6)</td>
<td>f</td>
<td>17</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
</tr>
</tbody>
</table>

<p>234 rows × 11 columns</p>
</div>
</div>
</div>
</section>
<section id="create-new-columns" class="level3" data-number="11.3.4">
<h3 data-number="11.3.4" class="anchored" data-anchor-id="create-new-columns"><span class="header-section-number">11.3.4</span> Create new columns</h3>
<p>You can use <code>assign()</code> to create new columns based on existing ones.</p>
<div id="29d811a1-bab8-47a3-a071-144fb7a506d5" class="cell" data-tags="[]" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mpg <span class="op">=</span> mpg.assign(displ_per_cyl <span class="op">=</span> mpg.displ<span class="op">/</span>mpg.cyl)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">displ</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">drv</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">hwy</th>
<th data-quarto-table-cell-role="th">fl</th>
<th data-quarto-table-cell-role="th">class</th>
<th data-quarto-table-cell-role="th">displ_per_cyl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>auto(l5)</td>
<td>f</td>
<td>18</td>
<td>29</td>
<td>p</td>
<td>compact</td>
<td>0.450000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>compact</td>
<td>0.450000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>20</td>
<td>31</td>
<td>p</td>
<td>compact</td>
<td>0.500000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(av)</td>
<td>f</td>
<td>21</td>
<td>30</td>
<td>p</td>
<td>compact</td>
<td>0.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>audi</td>
<td>a4</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
<td>compact</td>
<td>0.466667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">229</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(s6)</td>
<td>f</td>
<td>19</td>
<td>28</td>
<td>p</td>
<td>midsize</td>
<td>0.500000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">230</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>midsize</td>
<td>0.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">231</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
<td>0.466667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">232</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>manual(m5)</td>
<td>f</td>
<td>18</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
<td>0.466667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">233</td>
<td>volkswagen</td>
<td>passat</td>
<td>3.6</td>
<td>2008</td>
<td>6</td>
<td>auto(s6)</td>
<td>f</td>
<td>17</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
<td>0.600000</td>
</tr>
</tbody>
</table>

<p>234 rows × 12 columns</p>
</div>
</div>
</div>
</section>
<section id="grouping-and-summarizing" class="level3" data-number="11.3.5">
<h3 data-number="11.3.5" class="anchored" data-anchor-id="grouping-and-summarizing"><span class="header-section-number">11.3.5</span> Grouping and Summarizing</h3>
<p>This combines a couple functions that exist within Pandas to create <em>summary tables</em>.</p>
<p>Pandas has a wide range of summary statistics that you can apply to individual columns.</p>
<div id="ab1c6e56-acb0-40bd-ac8c-70b935ed3795" class="cell" data-tags="[]" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average city fuel efficiency</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>mpg.cty.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>np.float64(16.858974358974358)</code></pre>
</div>
</div>
<div id="78b0d4a6-dd76-4896-9d56-19710311d2ab" class="cell" data-tags="[]" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard deviation of highway fuel efficiency</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>mpg.hwy.std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>np.float64(5.9546434411664455)</code></pre>
</div>
</div>
<p>Pandas also has a <code>.groupby()</code> method (which returns a generator) that groups categorical variables.</p>
<div id="09769bc5-8fb9-4c3d-8d4c-032248dcb931" class="cell" data-tags="[]" data-execution_count="15">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mpg.groupby(<span class="st">"manufacturer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x10a116630&gt;</code></pre>
</div>
</div>
<p>By itself, <code>.groupby()</code> doesn’t show anything. It needs to be combined with a summary statistic to create a summary table.</p>
<div id="047aebe0-9dcf-4161-8568-bb8564b2e62d" class="cell" data-tags="[]" data-execution_count="16">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Averages by manufacturer</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># set `numeric_only=True` to avoid a warning</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>mpg.groupby(<span class="st">"manufacturer"</span>).mean(numeric_only<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">displ</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">hwy</th>
<th data-quarto-table-cell-role="th">displ_per_cyl</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">audi</td>
<td>2.544444</td>
<td>2003.500000</td>
<td>5.222222</td>
<td>17.611111</td>
<td>26.444444</td>
<td>0.484722</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chevrolet</td>
<td>5.063158</td>
<td>2004.684211</td>
<td>7.263158</td>
<td>15.000000</td>
<td>21.894737</td>
<td>0.686842</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">dodge</td>
<td>4.378378</td>
<td>2004.108108</td>
<td>7.081081</td>
<td>13.135135</td>
<td>17.945946</td>
<td>0.616216</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ford</td>
<td>4.536000</td>
<td>2002.600000</td>
<td>7.200000</td>
<td>14.000000</td>
<td>19.360000</td>
<td>0.633667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">honda</td>
<td>1.711111</td>
<td>2003.000000</td>
<td>4.000000</td>
<td>24.444444</td>
<td>32.555556</td>
<td>0.427778</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">hyundai</td>
<td>2.428571</td>
<td>2004.142857</td>
<td>4.857143</td>
<td>18.642857</td>
<td>26.857143</td>
<td>0.509524</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">jeep</td>
<td>4.575000</td>
<td>2005.750000</td>
<td>7.250000</td>
<td>13.500000</td>
<td>17.625000</td>
<td>0.627604</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">land rover</td>
<td>4.300000</td>
<td>2003.500000</td>
<td>8.000000</td>
<td>11.500000</td>
<td>16.500000</td>
<td>0.537500</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">lincoln</td>
<td>5.400000</td>
<td>2002.000000</td>
<td>8.000000</td>
<td>11.333333</td>
<td>17.000000</td>
<td>0.675000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mercury</td>
<td>4.400000</td>
<td>2003.500000</td>
<td>7.000000</td>
<td>13.250000</td>
<td>18.000000</td>
<td>0.633333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">nissan</td>
<td>3.269231</td>
<td>2003.846154</td>
<td>5.538462</td>
<td>18.076923</td>
<td>24.615385</td>
<td>0.589744</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">pontiac</td>
<td>3.960000</td>
<td>2002.600000</td>
<td>6.400000</td>
<td>17.000000</td>
<td>26.400000</td>
<td>0.615833</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">subaru</td>
<td>2.457143</td>
<td>2004.142857</td>
<td>4.000000</td>
<td>19.285714</td>
<td>25.571429</td>
<td>0.614286</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">toyota</td>
<td>2.952941</td>
<td>2002.705882</td>
<td>5.117647</td>
<td>18.529412</td>
<td>24.911765</td>
<td>0.573897</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">volkswagen</td>
<td>2.255556</td>
<td>2002.666667</td>
<td>4.592593</td>
<td>20.925926</td>
<td>29.222222</td>
<td>0.491049</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="dropping-null-values" class="level3" data-number="11.3.6">
<h3 data-number="11.3.6" class="anchored" data-anchor-id="dropping-null-values"><span class="header-section-number">11.3.6</span> Dropping Null Values</h3>
<p>For many statistical modeling tasks, you need to drop rows that contain null values. Pandas lets you do this easily with <code>.dropna()</code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pandas typically stores null values as NaN, which stands for “not a number.”</p>
</div>
</div>
<div id="4b3d2bc1-e7e1-4954-9ffa-77b11cfe4416" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop any row that contains a null value in any column</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>mpg <span class="op">=</span> mpg.dropna()</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">displ</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">drv</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">hwy</th>
<th data-quarto-table-cell-role="th">fl</th>
<th data-quarto-table-cell-role="th">class</th>
<th data-quarto-table-cell-role="th">displ_per_cyl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>auto(l5)</td>
<td>f</td>
<td>18</td>
<td>29</td>
<td>p</td>
<td>compact</td>
<td>0.450000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>compact</td>
<td>0.450000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>20</td>
<td>31</td>
<td>p</td>
<td>compact</td>
<td>0.500000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(av)</td>
<td>f</td>
<td>21</td>
<td>30</td>
<td>p</td>
<td>compact</td>
<td>0.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>audi</td>
<td>a4</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
<td>compact</td>
<td>0.466667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">229</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(s6)</td>
<td>f</td>
<td>19</td>
<td>28</td>
<td>p</td>
<td>midsize</td>
<td>0.500000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">230</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>midsize</td>
<td>0.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">231</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
<td>0.466667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">232</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>manual(m5)</td>
<td>f</td>
<td>18</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
<td>0.466667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">233</td>
<td>volkswagen</td>
<td>passat</td>
<td>3.6</td>
<td>2008</td>
<td>6</td>
<td>auto(s6)</td>
<td>f</td>
<td>17</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
<td>0.600000</td>
</tr>
</tbody>
</table>

<p>234 rows × 12 columns</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>mpg</code> dataset doesn’t contain any null values, so right now this code isn’t accomplishing anything. But it will work when null values are present!</p>
</div>
</div>
<p>You can also drop null values from only a subset of columns.</p>
<div id="e7808ee0-1988-4703-aa49-52bf8175d10e" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop any rows that contain null values in a subset of columns</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>mpg <span class="op">=</span> mpg.dropna(subset<span class="op">=</span>[<span class="st">"model"</span>, <span class="st">"displ"</span>])</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">displ</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">drv</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">hwy</th>
<th data-quarto-table-cell-role="th">fl</th>
<th data-quarto-table-cell-role="th">class</th>
<th data-quarto-table-cell-role="th">displ_per_cyl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>auto(l5)</td>
<td>f</td>
<td>18</td>
<td>29</td>
<td>p</td>
<td>compact</td>
<td>0.450000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>compact</td>
<td>0.450000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>20</td>
<td>31</td>
<td>p</td>
<td>compact</td>
<td>0.500000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(av)</td>
<td>f</td>
<td>21</td>
<td>30</td>
<td>p</td>
<td>compact</td>
<td>0.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>audi</td>
<td>a4</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
<td>compact</td>
<td>0.466667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">229</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(s6)</td>
<td>f</td>
<td>19</td>
<td>28</td>
<td>p</td>
<td>midsize</td>
<td>0.500000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">230</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>midsize</td>
<td>0.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">231</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
<td>0.466667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">232</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>manual(m5)</td>
<td>f</td>
<td>18</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
<td>0.466667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">233</td>
<td>volkswagen</td>
<td>passat</td>
<td>3.6</td>
<td>2008</td>
<td>6</td>
<td>auto(s6)</td>
<td>f</td>
<td>17</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
<td>0.600000</td>
</tr>
</tbody>
</table>

<p>234 rows × 12 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="sampling" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="sampling"><span class="header-section-number">11.4</span> Sampling</h2>
<p>Many statistical methods, especially hypothesis tests, require you to take a random sample of your overall data. Again, Pandas provides an easy way to do this with the <code>.sample()</code> method.</p>
<p>You can take a sample of rows from an entire dataframe.</p>
<div id="712f7ce7-c009-4e7e-ac55-cd6455016934" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get 5 random rows from mpg</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>mpg.sample(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">displ</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">drv</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">hwy</th>
<th data-quarto-table-cell-role="th">fl</th>
<th data-quarto-table-cell-role="th">class</th>
<th data-quarto-table-cell-role="th">displ_per_cyl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">179</td>
<td>toyota</td>
<td>camry</td>
<td>2.2</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>r</td>
<td>midsize</td>
<td>0.550000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">95</td>
<td>ford</td>
<td>mustang</td>
<td>4.6</td>
<td>1999</td>
<td>8</td>
<td>manual(m5)</td>
<td>r</td>
<td>15</td>
<td>22</td>
<td>r</td>
<td>subcompact</td>
<td>0.575000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">118</td>
<td>hyundai</td>
<td>tiburon</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(l4)</td>
<td>f</td>
<td>20</td>
<td>27</td>
<td>r</td>
<td>subcompact</td>
<td>0.500000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">86</td>
<td>ford</td>
<td>f150 pickup 4wd</td>
<td>4.6</td>
<td>1999</td>
<td>8</td>
<td>auto(l4)</td>
<td>4</td>
<td>13</td>
<td>16</td>
<td>r</td>
<td>pickup</td>
<td>0.575000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">47</td>
<td>dodge</td>
<td>caravan 2wd</td>
<td>4.0</td>
<td>2008</td>
<td>6</td>
<td>auto(l6)</td>
<td>f</td>
<td>16</td>
<td>23</td>
<td>r</td>
<td>minivan</td>
<td>0.666667</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>You can also get a sample of a specific column.</p>
<div id="c67abb42-9dc2-42e1-8860-f0321f85a9e3" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get 5 sample engine displacement values, as a series</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>mpg.displ.sample(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>60     4.7
158    5.3
220    2.8
146    3.5
0      1.8
Name: displ, dtype: float64</code></pre>
</div>
</div>
<p>You can also sample with replacement. (This is also called “bootstrap sampling.”) This makes it possible to have the same value in your sample twice.</p>
<div id="739621c8-f942-4004-a5f4-294adab50862" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mpg.displ.sample(<span class="dv">5</span>, replace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>25     6.2
124    4.0
13     3.1
68     4.7
81     4.6
Name: displ, dtype: float64</code></pre>
</div>
</div>
<p>Pandas will also let you get a fraction of values instead of a set number in your sample.</p>
<div id="780bf156-f4be-4dae-854c-cded2d73d05e" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a random sample of one twentieth the size of the dataset</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>mpg.sample(frac<span class="op">=</span><span class="fl">.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">displ</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">drv</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">hwy</th>
<th data-quarto-table-cell-role="th">fl</th>
<th data-quarto-table-cell-role="th">class</th>
<th data-quarto-table-cell-role="th">displ_per_cyl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">64</td>
<td>dodge</td>
<td>ram 1500 pickup 4wd</td>
<td>4.7</td>
<td>2008</td>
<td>8</td>
<td>manual(m6)</td>
<td>4</td>
<td>12</td>
<td>16</td>
<td>r</td>
<td>pickup</td>
<td>0.587500</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">136</td>
<td>lincoln</td>
<td>navigator 2wd</td>
<td>5.4</td>
<td>2008</td>
<td>8</td>
<td>auto(l6)</td>
<td>r</td>
<td>12</td>
<td>18</td>
<td>r</td>
<td>suv</td>
<td>0.675000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">138</td>
<td>mercury</td>
<td>mountaineer 4wd</td>
<td>4.0</td>
<td>2008</td>
<td>6</td>
<td>auto(l5)</td>
<td>4</td>
<td>13</td>
<td>19</td>
<td>r</td>
<td>suv</td>
<td>0.666667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">223</td>
<td>volkswagen</td>
<td>new beetle</td>
<td>2.0</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>r</td>
<td>subcompact</td>
<td>0.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>audi</td>
<td>a6 quattro</td>
<td>3.1</td>
<td>2008</td>
<td>6</td>
<td>auto(s6)</td>
<td>4</td>
<td>17</td>
<td>25</td>
<td>p</td>
<td>midsize</td>
<td>0.516667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">186</td>
<td>toyota</td>
<td>camry solara</td>
<td>2.2</td>
<td>1999</td>
<td>4</td>
<td>auto(l4)</td>
<td>f</td>
<td>21</td>
<td>27</td>
<td>r</td>
<td>compact</td>
<td>0.550000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>20</td>
<td>31</td>
<td>p</td>
<td>compact</td>
<td>0.500000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">133</td>
<td>land rover</td>
<td>range rover</td>
<td>4.6</td>
<td>1999</td>
<td>8</td>
<td>auto(l4)</td>
<td>4</td>
<td>11</td>
<td>15</td>
<td>p</td>
<td>suv</td>
<td>0.575000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>compact</td>
<td>0.450000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">182</td>
<td>toyota</td>
<td>camry</td>
<td>2.4</td>
<td>2008</td>
<td>4</td>
<td>auto(l5)</td>
<td>f</td>
<td>21</td>
<td>31</td>
<td>r</td>
<td>midsize</td>
<td>0.600000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">169</td>
<td>subaru</td>
<td>impreza awd</td>
<td>2.5</td>
<td>2008</td>
<td>4</td>
<td>auto(s4)</td>
<td>4</td>
<td>20</td>
<td>25</td>
<td>p</td>
<td>compact</td>
<td>0.625000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">119</td>
<td>hyundai</td>
<td>tiburon</td>
<td>2.7</td>
<td>2008</td>
<td>6</td>
<td>auto(l4)</td>
<td>f</td>
<td>17</td>
<td>24</td>
<td>r</td>
<td>subcompact</td>
<td>0.450000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>There’s one more trick you can do with sampling. Sometimes you don’t need to get a smaller random sample: instead, you just want to reshuffle every row of the dataset. You can do this by setting <code>frac</code> to 1. In a way, you’re taking a random sample that is 100% of the size of the dataset! (But make sure you do this <em>without</em> replacement.)</p>
<div id="04c4bd3f-253e-4494-b6cd-06f620cd9b64" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mpg.displ.sample(frac<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>123    3.7
210    2.0
12     2.8
212    1.9
77     4.0
      ... 
88     5.4
169    2.5
232    2.8
222    1.9
72     5.7
Name: displ, Length: 234, dtype: float64</code></pre>
</div>
</div>
<p>Pandas will remember the indices in your new Series, which means if you use this reordered sample it might put things back in order for you! To avoid this, you can reset the index and drop the old labels.</p>
<div id="29cd2eb1-7965-4b49-a627-a4c87e53de3e" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mpg.displ.sample(frac<span class="op">=</span><span class="dv">1</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>0      2.5
1      3.6
2      3.0
3      5.0
4      3.8
      ... 
229    2.8
230    3.0
231    4.6
232    4.0
233    3.5
Name: displ, Length: 234, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="combining-datasets" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="combining-datasets"><span class="header-section-number">11.5</span> Combining Datasets</h2>
<section id="stack-data-with-concatenation" class="level3" data-number="11.5.1">
<h3 data-number="11.5.1" class="anchored" data-anchor-id="stack-data-with-concatenation"><span class="header-section-number">11.5.1</span> Stack Data with Concatenation</h3>
<p>If you have two datasets with identical columns but different rows, you can combine or “stack” the two datasets into one.</p>
<div id="d6553e13-ee23-4a61-9866-3003e0825ad7" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's imagine we have two datasets.</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># One for manual transmission cars:</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>manual <span class="op">=</span> pd.read_csv(<span class="st">"../data/manual.csv"</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>manual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">displ</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">drv</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">hwy</th>
<th data-quarto-table-cell-role="th">fl</th>
<th data-quarto-table-cell-role="th">class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>20</td>
<td>31</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>audi</td>
<td>a4</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>manual(m5)</td>
<td>f</td>
<td>18</td>
<td>26</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>audi</td>
<td>a4 quattro</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>4</td>
<td>18</td>
<td>26</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>audi</td>
<td>a4 quattro</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>4</td>
<td>20</td>
<td>28</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">72</td>
<td>volkswagen</td>
<td>new beetle</td>
<td>2.0</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">73</td>
<td>volkswagen</td>
<td>new beetle</td>
<td>2.5</td>
<td>2008</td>
<td>5</td>
<td>manual(m5)</td>
<td>f</td>
<td>20</td>
<td>28</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">74</td>
<td>volkswagen</td>
<td>passat</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>manual(m5)</td>
<td>f</td>
<td>18</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
</tr>
</tbody>
</table>

<p>77 rows × 11 columns</p>
</div>
</div>
</div>
<div id="bf43dfa6-56d5-417f-9e0c-4ce045959ecd" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># And one for automatic transmissions:</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>automatic <span class="op">=</span> pd.read_csv(<span class="st">"../data/automatic.csv"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>automatic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">displ</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">drv</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">hwy</th>
<th data-quarto-table-cell-role="th">fl</th>
<th data-quarto-table-cell-role="th">class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>auto(l5)</td>
<td>f</td>
<td>18</td>
<td>29</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(av)</td>
<td>f</td>
<td>21</td>
<td>30</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>audi</td>
<td>a4</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>audi</td>
<td>a4</td>
<td>3.1</td>
<td>2008</td>
<td>6</td>
<td>auto(av)</td>
<td>f</td>
<td>18</td>
<td>27</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>audi</td>
<td>a4 quattro</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>auto(l5)</td>
<td>4</td>
<td>16</td>
<td>25</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">152</td>
<td>volkswagen</td>
<td>new beetle</td>
<td>2.5</td>
<td>2008</td>
<td>5</td>
<td>auto(s6)</td>
<td>f</td>
<td>20</td>
<td>29</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">153</td>
<td>volkswagen</td>
<td>passat</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>auto(l5)</td>
<td>f</td>
<td>18</td>
<td>29</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">154</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(s6)</td>
<td>f</td>
<td>19</td>
<td>28</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">155</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">156</td>
<td>volkswagen</td>
<td>passat</td>
<td>3.6</td>
<td>2008</td>
<td>6</td>
<td>auto(s6)</td>
<td>f</td>
<td>17</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
</tr>
</tbody>
</table>

<p>157 rows × 11 columns</p>
</div>
</div>
</div>
<div id="689d03c5-d51d-4ee6-994c-050c197d6cda" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You can combine these into one with pd.concat()</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>mpg_concat <span class="op">=</span> pd.concat([manual, automatic])</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>mpg_concat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">displ</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">drv</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">hwy</th>
<th data-quarto-table-cell-role="th">fl</th>
<th data-quarto-table-cell-role="th">class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>20</td>
<td>31</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>audi</td>
<td>a4</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>manual(m5)</td>
<td>f</td>
<td>18</td>
<td>26</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>audi</td>
<td>a4 quattro</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>4</td>
<td>18</td>
<td>26</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>audi</td>
<td>a4 quattro</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>4</td>
<td>20</td>
<td>28</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">152</td>
<td>volkswagen</td>
<td>new beetle</td>
<td>2.5</td>
<td>2008</td>
<td>5</td>
<td>auto(s6)</td>
<td>f</td>
<td>20</td>
<td>29</td>
<td>r</td>
<td>subcompact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">153</td>
<td>volkswagen</td>
<td>passat</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>auto(l5)</td>
<td>f</td>
<td>18</td>
<td>29</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">154</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(s6)</td>
<td>f</td>
<td>19</td>
<td>28</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">155</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">156</td>
<td>volkswagen</td>
<td>passat</td>
<td>3.6</td>
<td>2008</td>
<td>6</td>
<td>auto(s6)</td>
<td>f</td>
<td>17</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
</tr>
</tbody>
</table>

<p>234 rows × 11 columns</p>
</div>
</div>
</div>
</section>
<section id="switch-rows-and-columns-with-pivot-and-melt" class="level3" data-number="11.5.2">
<h3 data-number="11.5.2" class="anchored" data-anchor-id="switch-rows-and-columns-with-pivot-and-melt"><span class="header-section-number">11.5.2</span> Switch Rows and Columns with Pivot and Melt</h3>
<p>Sometimes your data isn’t tidy, and rows should be columns while columns should be rows. You can resolve these problems using Pandas’ “pivot” and “melt” concepts—this is similar to Pivot Tables in Excel.</p>
<div id="449dc66c-be3a-489d-93e7-a1f2d25d57ba" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's imagine you have a dataset with column headings in the rows</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>long_mpg <span class="op">=</span> pd.read_csv(<span class="st">"../data/melted_mpg.csv"</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>long_mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">variable</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>audi</td>
<td>a4</td>
<td>1999</td>
<td>auto(l5)</td>
<td>displ</td>
<td>1.8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>audi</td>
<td>a4</td>
<td>1999</td>
<td>manual(m5)</td>
<td>displ</td>
<td>1.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>audi</td>
<td>a4</td>
<td>2008</td>
<td>manual(m6)</td>
<td>displ</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>audi</td>
<td>a4</td>
<td>2008</td>
<td>auto(av)</td>
<td>displ</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>audi</td>
<td>a4 quattro</td>
<td>1999</td>
<td>manual(m5)</td>
<td>displ</td>
<td>1.8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">968</td>
<td>volkswagen</td>
<td>new beetle</td>
<td>2008</td>
<td>auto(s6)</td>
<td>class</td>
<td>subcompact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">969</td>
<td>volkswagen</td>
<td>passat</td>
<td>1999</td>
<td>manual(m5)</td>
<td>class</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">970</td>
<td>volkswagen</td>
<td>passat</td>
<td>1999</td>
<td>auto(l5)</td>
<td>class</td>
<td>midsize</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">971</td>
<td>volkswagen</td>
<td>passat</td>
<td>2008</td>
<td>auto(s6)</td>
<td>class</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">972</td>
<td>volkswagen</td>
<td>passat</td>
<td>2008</td>
<td>manual(m6)</td>
<td>class</td>
<td>midsize</td>
</tr>
</tbody>
</table>

<p>973 rows × 6 columns</p>
</div>
</div>
</div>
<div id="81fb86d1-82e3-46e1-9014-fa78e064a3fc" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use pivot to turn the "variable" column into the column names</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># You must specify which columns you want to retain as indices</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure you add .reset_index()</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>pivoted_mpg <span class="op">=</span> long_mpg.pivot(index<span class="op">=</span>[<span class="st">"manufacturer"</span>, <span class="st">"model"</span>, <span class="st">"year"</span>, <span class="st">"trans"</span>], columns<span class="op">=</span><span class="st">"variable"</span>, values<span class="op">=</span><span class="st">"value"</span>).reset_index()</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>pivoted_mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">variable</th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">class</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">displ</th>
<th data-quarto-table-cell-role="th">drv</th>
<th data-quarto-table-cell-role="th">fl</th>
<th data-quarto-table-cell-role="th">hwy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>audi</td>
<td>a4</td>
<td>1999</td>
<td>auto(l5)</td>
<td>compact</td>
<td>18</td>
<td>4</td>
<td>1.8</td>
<td>f</td>
<td>p</td>
<td>29</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>audi</td>
<td>a4</td>
<td>1999</td>
<td>manual(m5)</td>
<td>compact</td>
<td>21</td>
<td>4</td>
<td>1.8</td>
<td>f</td>
<td>p</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>audi</td>
<td>a4</td>
<td>2008</td>
<td>auto(av)</td>
<td>compact</td>
<td>21</td>
<td>4</td>
<td>2.0</td>
<td>f</td>
<td>p</td>
<td>30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>audi</td>
<td>a4</td>
<td>2008</td>
<td>manual(m6)</td>
<td>compact</td>
<td>20</td>
<td>4</td>
<td>2.0</td>
<td>f</td>
<td>p</td>
<td>31</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>audi</td>
<td>a4 quattro</td>
<td>1999</td>
<td>auto(l5)</td>
<td>compact</td>
<td>16</td>
<td>4</td>
<td>1.8</td>
<td>4</td>
<td>p</td>
<td>25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">134</td>
<td>volkswagen</td>
<td>new beetle</td>
<td>2008</td>
<td>manual(m5)</td>
<td>subcompact</td>
<td>20</td>
<td>5</td>
<td>2.5</td>
<td>f</td>
<td>r</td>
<td>28</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">135</td>
<td>volkswagen</td>
<td>passat</td>
<td>1999</td>
<td>auto(l5)</td>
<td>midsize</td>
<td>18</td>
<td>4</td>
<td>1.8</td>
<td>f</td>
<td>p</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">136</td>
<td>volkswagen</td>
<td>passat</td>
<td>1999</td>
<td>manual(m5)</td>
<td>midsize</td>
<td>21</td>
<td>4</td>
<td>1.8</td>
<td>f</td>
<td>p</td>
<td>29</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">137</td>
<td>volkswagen</td>
<td>passat</td>
<td>2008</td>
<td>auto(s6)</td>
<td>midsize</td>
<td>19</td>
<td>4</td>
<td>2.0</td>
<td>f</td>
<td>p</td>
<td>28</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">138</td>
<td>volkswagen</td>
<td>passat</td>
<td>2008</td>
<td>manual(m6)</td>
<td>midsize</td>
<td>21</td>
<td>4</td>
<td>2.0</td>
<td>f</td>
<td>p</td>
<td>29</td>
</tr>
</tbody>
</table>

<p>139 rows × 11 columns</p>
</div>
</div>
</div>
<div id="83c82425-edce-4921-a00f-4ddb11455e5c" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You can use .melt() to go in the opposite direction</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Again you must specify the columns you want to keep as indices</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>melted_mpg <span class="op">=</span> pivoted_mpg.melt(id_vars <span class="op">=</span> [<span class="st">"manufacturer"</span>, <span class="st">"model"</span>, <span class="st">"year"</span>, <span class="st">"trans"</span>])</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>melted_mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">variable</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>audi</td>
<td>a4</td>
<td>1999</td>
<td>auto(l5)</td>
<td>class</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>audi</td>
<td>a4</td>
<td>1999</td>
<td>manual(m5)</td>
<td>class</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>audi</td>
<td>a4</td>
<td>2008</td>
<td>auto(av)</td>
<td>class</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>audi</td>
<td>a4</td>
<td>2008</td>
<td>manual(m6)</td>
<td>class</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>audi</td>
<td>a4 quattro</td>
<td>1999</td>
<td>auto(l5)</td>
<td>class</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">968</td>
<td>volkswagen</td>
<td>new beetle</td>
<td>2008</td>
<td>manual(m5)</td>
<td>hwy</td>
<td>28</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">969</td>
<td>volkswagen</td>
<td>passat</td>
<td>1999</td>
<td>auto(l5)</td>
<td>hwy</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">970</td>
<td>volkswagen</td>
<td>passat</td>
<td>1999</td>
<td>manual(m5)</td>
<td>hwy</td>
<td>29</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">971</td>
<td>volkswagen</td>
<td>passat</td>
<td>2008</td>
<td>auto(s6)</td>
<td>hwy</td>
<td>28</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">972</td>
<td>volkswagen</td>
<td>passat</td>
<td>2008</td>
<td>manual(m6)</td>
<td>hwy</td>
<td>29</td>
</tr>
</tbody>
</table>

<p>973 rows × 6 columns</p>
</div>
</div>
</div>
</section>
<section id="join-datasets-with-merge" class="level3" data-number="11.5.3">
<h3 data-number="11.5.3" class="anchored" data-anchor-id="join-datasets-with-merge"><span class="header-section-number">11.5.3</span> Join Datasets with Merge</h3>
<p>If your columns or rows don’t match exactly, you can’t use <code>pd.concat()</code>. But you can still combine datasets with a database-style JOIN (just like in SQL!) using the <code>pd.merge()</code> function.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>This database-style combining of tables is really powerful, and it can get more complicated than what we have time to cover in this class. I recommend checking out <a href="https://wesmckinney.com/book/data-wrangling#prep_merge_join">McKinney Ch. 8.2</a> for more details, and this all is covered in much more detail in CIS 112!</p>
</div>
</div>
<div id="3bb6ab6c-0029-42df-9018-20c22b71a0c0" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's assume you have a dataset without the vehicle class column</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>missing_mpg <span class="op">=</span> pd.read_csv(<span class="st">"../data/mpg_no_class.csv"</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>missing_mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">displ</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">drv</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">hwy</th>
<th data-quarto-table-cell-role="th">fl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>auto(l5)</td>
<td>f</td>
<td>18</td>
<td>29</td>
<td>p</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>20</td>
<td>31</td>
<td>p</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(av)</td>
<td>f</td>
<td>21</td>
<td>30</td>
<td>p</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>audi</td>
<td>a4</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">229</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(s6)</td>
<td>f</td>
<td>19</td>
<td>28</td>
<td>p</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">230</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">231</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">232</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>manual(m5)</td>
<td>f</td>
<td>18</td>
<td>26</td>
<td>p</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">233</td>
<td>volkswagen</td>
<td>passat</td>
<td>3.6</td>
<td>2008</td>
<td>6</td>
<td>auto(s6)</td>
<td>f</td>
<td>17</td>
<td>26</td>
<td>p</td>
</tr>
</tbody>
</table>

<p>234 rows × 10 columns</p>
</div>
</div>
</div>
<div id="1c917c0f-6232-44d6-a9f4-bc5fa48153ad" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># And you also have a dataset (with fewer rows) that has</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># class info for each make and year of vehicle</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>class_mpg <span class="op">=</span> pd.read_csv(<span class="st">"../data/mpg_class.csv"</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>class_mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>audi</td>
<td>a4</td>
<td>1999</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>audi</td>
<td>a4</td>
<td>2008</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>audi</td>
<td>a4 quattro</td>
<td>1999</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>audi</td>
<td>a4 quattro</td>
<td>2008</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>audi</td>
<td>a6 quattro</td>
<td>1999</td>
<td>midsize</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">71</td>
<td>volkswagen</td>
<td>jetta</td>
<td>2008</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">72</td>
<td>volkswagen</td>
<td>new beetle</td>
<td>1999</td>
<td>subcompact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">73</td>
<td>volkswagen</td>
<td>new beetle</td>
<td>2008</td>
<td>subcompact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">74</td>
<td>volkswagen</td>
<td>passat</td>
<td>1999</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75</td>
<td>volkswagen</td>
<td>passat</td>
<td>2008</td>
<td>midsize</td>
</tr>
</tbody>
</table>

<p>76 rows × 4 columns</p>
</div>
</div>
</div>
<div id="81abd452-175c-4d91-8184-6e73f380f8fc" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You can add the class column to your dataframe using merge</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>merged_mpg <span class="op">=</span> pd.merge(missing_mpg, class_mpg, how<span class="op">=</span><span class="st">"left"</span>, on<span class="op">=</span>[<span class="st">"manufacturer"</span>, <span class="st">"model"</span>, <span class="st">"year"</span>])</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>merged_mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">manufacturer</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">displ</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">trans</th>
<th data-quarto-table-cell-role="th">drv</th>
<th data-quarto-table-cell-role="th">cty</th>
<th data-quarto-table-cell-role="th">hwy</th>
<th data-quarto-table-cell-role="th">fl</th>
<th data-quarto-table-cell-role="th">class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>auto(l5)</td>
<td>f</td>
<td>18</td>
<td>29</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>audi</td>
<td>a4</td>
<td>1.8</td>
<td>1999</td>
<td>4</td>
<td>manual(m5)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>20</td>
<td>31</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>audi</td>
<td>a4</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(av)</td>
<td>f</td>
<td>21</td>
<td>30</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>audi</td>
<td>a4</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
<td>compact</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">229</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>auto(s6)</td>
<td>f</td>
<td>19</td>
<td>28</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">230</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.0</td>
<td>2008</td>
<td>4</td>
<td>manual(m6)</td>
<td>f</td>
<td>21</td>
<td>29</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">231</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>auto(l5)</td>
<td>f</td>
<td>16</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">232</td>
<td>volkswagen</td>
<td>passat</td>
<td>2.8</td>
<td>1999</td>
<td>6</td>
<td>manual(m5)</td>
<td>f</td>
<td>18</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">233</td>
<td>volkswagen</td>
<td>passat</td>
<td>3.6</td>
<td>2008</td>
<td>6</td>
<td>auto(s6)</td>
<td>f</td>
<td>17</td>
<td>26</td>
<td>p</td>
<td>midsize</td>
</tr>
</tbody>
</table>

<p>234 rows × 11 columns</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wes McKinney’s excellent book <em>Python for Data Analysis</em> has lots more examples and many additional function. In particular, you can check out <a href="https://wesmckinney.com/book/pandas-basics.html#pandas_frame">Chapter 5</a> and <a href="https://wesmckinney.com/book/data-wrangling.html">Chapter 8</a>.</p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../guides/python.html" class="pagination-link" aria-label="Python">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Python</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../guides/altair.html" class="pagination-link" aria-label="Altair">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Altair</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>